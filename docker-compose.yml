version: "3.3"
networks:
  web:
    external: true
services:
    landing:
        build:
            context: .
            args:
              - SSH_PRV_KEY=$SSH_PRV_KEY
              - SSH_PUB_KEY=$SSH_PUB_KEY
        networks:
          - web
        labels:
          - "traefik.enable=true"
          - "traefik.http.routers.landing.rule=Host(`rigami.io`)"
          - "traefik.http.routers.landing.entrypoints=http,https"
          - "traefik.http.routers.landing.middlewares=redirect-to-https@file"
          - "traefik.http.routers.landing.tls=true"
          - "traefik.http.routers.landing.tls.certresolver=letsEncrypt"
          - "traefik.http.services.landing-service.loadbalancer.server.port=80"
